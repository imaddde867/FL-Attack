============================================================
  ABLATION STUDY (Lean & Fair)
============================================================
  Clients:  0 3 7
  Budget:   iters=2000, restarts=3
  Output:   results/ablation
============================================================


============================================================
  [1/7] BASELINE: TV=1e-5, L2, plain init
============================================================

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
  ABLATION: baseline
  Args: --tv-weight 1e-5 --match-metric l2
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
  → Client 0...
/Users/imadeddine/miniconda3/lib/python3.13/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/Users/imadeddine/miniconda3/lib/python3.13/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=AlexNet_Weights.IMAGENET1K_V1`. You can also use `weights=AlexNet_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
------------------------------------------------------------
EXPERIMENT 1: BASELINE (No Privacy Protection - without DP or HE)
------------------------------------------------------------
Using device: mps
Setting up [LPIPS] perceptual loss: trunk [alex], v[0.1], spatial [off]
Loading model from: /Users/imadeddine/miniconda3/lib/python3.13/site-packages/lpips/weights/v0.1/alex.pth
Initializing FL System (configurable via CLI)...

Phase 1: Training FL Model...
Starting Round 0...
Round 0: Accuracy = 60.00%
  -> Captured gradients from client 0!

============================================================
Phase 2: Gradient Inversion Attack...
============================================================
Reconstructing image from captured signal...
Inferred label: 0
Iter 0/2000: Loss = 1.9656 (best: 1.9656)
Iter 250/2000: Loss = 0.6075 (best: 0.5948)
Iter 500/2000: Loss = 0.6084 (best: 0.5948)
Iter 750/2000: Loss = 0.6083 (best: 0.5948)
Iter 1000/2000: Loss = 0.6074 (best: 0.5948)
Iter 1250/2000: Loss = 0.6074 (best: 0.5948)
Iter 1500/2000: Loss = 0.6075 (best: 0.5948)
Iter 1750/2000: Loss = 0.6070 (best: 0.5948)
Inferred label: 0
Iter 0/2000: Loss = 1.9698 (best: 1.9698)
Iter 250/2000: Loss = 0.6087 (best: 0.6015)
Iter 500/2000: Loss = 0.6085 (best: 0.6015)
Iter 750/2000: Loss = 0.6083 (best: 0.6015)
Iter 1000/2000: Loss = 0.6078 (best: 0.6015)
Iter 1250/2000: Loss = 0.6074 (best: 0.6015)
Iter 1500/2000: Loss = 0.6073 (best: 0.6015)
Iter 1750/2000: Loss = 0.6068 (best: 0.6015)
Inferred label: 0
Iter 0/2000: Loss = 1.9732 (best: 1.9732)
Iter 250/2000: Loss = 0.5949 (best: 0.5943)
Iter 500/2000: Loss = 0.6087 (best: 0.5943)
Iter 750/2000: Loss = 0.6083 (best: 0.5943)
Iter 1000/2000: Loss = 0.6078 (best: 0.5943)
Iter 1250/2000: Loss = 0.5934 (best: 0.5934)
Iter 1500/2000: Loss = 0.5935 (best: 0.5932)
Iter 1750/2000: Loss = 0.5935 (best: 0.5931)
Saving result to 'results/ablation/baseline/c0/baseline_attack_result.png'...
Result saved.

Attack Results:
  MSE: 0.02633032761514187
  PSNR: 27.836637198064793
  SSIM: 0.9404812455177307
  LPIPS: 0.10311239957809448
  LabelMatch: 1.0
  Saved metrics: results/ablation/baseline/c0/metrics.txt
  → Client 3...
Fatal Python error: init_sys_streams: can't initialize sys standard streams
Python runtime state: core initialized
OSError: [Errno 9] Bad file descriptor

Current thread 0x000000020bc72c40 (most recent call first):
  <no Python frame>
